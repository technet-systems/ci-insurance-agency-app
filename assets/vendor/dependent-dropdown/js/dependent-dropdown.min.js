/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2013 - 2016
 * http://plugins.krajee.com/dependent-dropdown
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2016, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/dependent-dropdown/blob/master/LICENSE.md
 */!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";e.fn.depdropLocales={};var a,t,n,d;a=function(a,t){return null===a||void 0===a||0===a.length||t&&""===e.trim(a)},t=function(a,t,n,d,i){var r={value:t,text:n},o=t.toString();e.extend(!0,r,i||{}),null!==d&&d.length&&(o===d||a.attr("multiple")&&d instanceof Array&&e.inArray(o,d)>-1)&&(r.selected="selected"),e("<option/>",r).appendTo(a)},n=function(a,t){var n={};return 0===a.length?{}:(e.each(a,function(e,a){n[a]=t[e]}),n)},d=function(a,t){var n=this;n.$element=e(a),e.each(t,function(e,a){n[e]=a}),n.initData(),n.init()},d.prototype={constructor:d,initData:function(){var e=this,a=e.$element;e.initVal=a.val(),a.data("url",e.url).data("placeholder",e.placeholder).data("loading",e.loading).data("loadingClass",e.loadingClass).data("loadingText",e.loadingText).data("emptyMsg",e.emptyMsg).data("params",e.params)},init:function(){var a,t=this,n=t.depends,d=t.$element,i=n.length,r=d.find("option").length,o=t.initDepends||t.depends;for(0!==r&&d.find('option[value=""]').length!==r||d.attr("disabled","disabled"),a=0;i>a;a++)t.listen(a,n,i);if(t.initialize===!0)for(a=0;a<o.length;a++)e("#"+o[a]).trigger("depdrop.change");d.trigger("depdrop.init")},parseDisabled:function(){var e=this;e.isDisabled&&e.$element.attr("disabled","disabled")},listen:function(t,n,d){var i=this;e("#"+n[t]).on("depdrop.change change select2:select krajeeselect2:cleared",function(t){var r=e(this);(a(r.data("select2"))||"change"!==t.type)&&i.setDep(r,n,d)}),i.parseDisabled()},setDep:function(a,t,n){for(var d,i,r=this,o={},l=0;n>l;l++)d=e("#"+t[l]),i=d.attr("type"),o[l]="checkbox"===i||"radio"===i?d.prop("checked"):d.val();r.processDep(r.$element,a.attr("id"),o,t)},processDep:function(d,i,r,o){var l,p,s,c,u,f=this,g=0,h={},m={},v=d.data("url"),y=n(o,r),b={},x=d.data("placeholder"),D=d.data("loading"),P=d.data("loadingClass"),j=d.data("loadingText"),C=d.data("emptyMsg"),S=d.data("params");if(m[f.parentParam]=r,!a(S)){for(s=0;s<S.length;s++)c=S[s],u=e("#"+S[s]).val(),h[s]=u,b[c]=u;m[f.otherParam]=h}m[f.allParam]=e.extend(!0,{},y,b),p={url:v,type:"post",data:m,dataType:"json",beforeSend:function(){d.trigger("depdrop.beforeChange",[i,e("#"+i).val(),f.initVal]),d.find("option[selected]").removeAttr("selected"),d.val("").attr("disabled","disabled").html(""),D&&d.removeClass(P).addClass(P).html('<option id="">'+j+"</option>")},success:function(n){l=a(n.selected)?f.initVal===!1?null:f.initVal:n.selected,a(n)?t(d,"",C,""):(d.html(f.getSelect(n.output,x,l)),d.find("optgroup").length>0&&d.find('option[value=""]').attr("disabled","disabled"),n.output&&d.removeAttr("disabled")),g=d.find("option").length,d.find('option[value=""]').length>0&&(g-=1),d.trigger("depdrop.change",[i,e("#"+i).val(),g,f.initVal]),f.parseDisabled()},error:function(){d.trigger("depdrop.error",[i,e("#"+i).val(),f.initVal])},complete:function(){D&&d.removeClass(P),d.trigger("depdrop.afterChange",[i,e("#"+i).val(),f.initVal])}},e.extend(!0,p,f.ajaxSettings),e.ajax(p)},getSelect:function(n,d,i){var r,o=this,l=e("<select>"),p=o.idParam,s=o.nameParam;return d!==!1&&t(l,"",d,i),a(n)&&(n={}),e.each(n,function(a,n){if(n[p])r=n[o.optionsParam]||{},t(l,n[p],n[s],i,r);else{var d=e("<optgroup>",{label:a});e.each(n,function(e,a){r=a[o.optionsParam]||{},t(d,a[p],a[s],i,r)}),d.appendTo(l)}}),l.html()}},e.fn.depdrop=function(t){var n=Array.apply(null,arguments),i=[];switch(n.shift(),this.each(function(){var r=e(this),o=r.data("depdrop"),l="object"==typeof t&&t,p=l.language||r.data("language")||"en",s={},c={};o||("en"===p||a(e.fn.depdropLocales[p])||(s=e.fn.depdropLocales[p]),e.extend(!0,c,e.fn.depdrop.defaults,e.fn.depdropLocales.en,s,l,r.data()),o=new d(this,c),r.data("depdrop",o)),"string"==typeof t&&i.push(o[t].apply(o,n))}),i.length){case 0:return this;case 1:return i[0];default:return i}},e.fn.depdrop.defaults={language:"en",url:"",depends:"",initDepends:"",loading:!0,loadingClass:"kv-loading",initialize:!1,idParam:"id",nameParam:"name",optionsParam:"options",parentParam:"depdrop_parents",otherParam:"depdrop_params",allParam:"depdrop_all_params",params:{},isDisabled:!1,ajaxSettings:{}},e.fn.depdropLocales.en={loadingText:"Loading ...",placeholder:"Wybierz...",emptyMsg:"No data found"},e.fn.depdrop.Constructor=d,e(function(){e("select.depdrop").depdrop()})});